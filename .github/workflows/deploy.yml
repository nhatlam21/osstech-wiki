name: Auto Deploy to Local Laptop

on:
  push:
    branches: ["main"]

jobs:
  deploy:
    runs-on: self-hosted
    
    # üëá QUAN TR·ªåNG: D√≤ng n√†y b·∫Øt Runner chui v√†o ƒë√∫ng th∆∞ m·ª•c d·ª± √°n
    defaults:
      run:
        working-directory: ./my-internal-portal

    steps:
      - name: L·∫•y code m·ªõi nh·∫•t v·ªÅ
        uses: actions/checkout@v3

      - name: C√†i ƒë·∫∑t th∆∞ vi·ªán
        run: npm install

      - name: Kh·ªüi ƒë·ªông l·∫°i Server
        # N·∫øu l·ª° Server ch∆∞a ch·∫°y th√¨ ch·∫°y m·ªõi, n·∫øu ch·∫°y r·ªìi th√¨ reload
        run: |
          pm2 reload osstech-wiki || pm2 start ecosystem.config.js